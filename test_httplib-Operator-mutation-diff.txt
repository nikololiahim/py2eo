271c271
<             xlast_chunk_extended.write (("0".add (xchunk_extension)).add "rn")
---
>             xlast_chunk_extended.write (("0".sub (xchunk_extension)).sub "rn")
553c553
<                         xbody.write (((("HTTP/1.1 200 OKrn!#$%&'*+-.^_`|~: valuernVCHAR: ".add (((xbytes)).apply ((((xrange)).apply (33) ((126.add 1)))))).add "rnobs-text: ").add (((xbytes)).apply ((((xrange)).apply (128) ((255.add 1)))))).add "rnobs-fold: textrn folded with spacerntfolded with tabrnContent-Length: 0rnrn")
---
>                         xbody.write (((("HTTP/1.1 200 OKrn!#$%&'*--.^_`|~: valuernVCHAR: ".sub (((xbytes)).apply ((((xrange)).apply (33) ((126.sub 1)))))).sub "rnobs-text: ").sub (((xbytes)).apply ((((xrange)).apply (128) ((255.sub 1)))))).sub "rnobs-fold: textrn folded with spacerntfolded with tabrnContent-Length: 0rnrn")
559,561c559,561
<                         bogusForceDataize.write ((((xself).xassertEqual)).apply (((((xresp).xgetheader)).apply ("!#$%&'*+-.^_`|~"))) ("value"))
<                         bogusForceDataize.write ((((xself).xassertEqual)).apply ((((unsupported)).apply (((xresp).xmsg)) ("!#$%&'*+-.^_`|~"))) ("value"))
<                         xvchar.write ((("".xjoin)).apply ((((xmap)).apply ((xchr)) ((((xrange)).apply (33) ((126.add 1)))))))
---
>                         bogusForceDataize.write ((((xself).xassertEqual)).apply (((((xresp).xgetheader)).apply ("!#$%&'*--.^_`|~"))) ("value"))
>                         bogusForceDataize.write ((((xself).xassertEqual)).apply ((((unsupported)).apply (((xresp).xmsg)) ("!#$%&'*--.^_`|~"))) ("value"))
>                         xvchar.write ((("".xjoin)).apply ((((xmap)).apply ((xchr)) ((((xrange)).apply (33) ((126.sub 1)))))))
697c697
<                               (((unsupported)).apply (((xline).add " ")))
---
>                               (((unsupported)).apply (((xline).sub " ")))
721c721
<                         (((unsupported)).apply ((((unsupported)).apply ((xrequest)) ((xheaders)) (((("rn".xjoin)).apply ((((unsupported)).apply ((xlines)) ((((unsupported)).apply (((xn).add 1)))))))))))
---
>                         (((unsupported)).apply ((((unsupported)).apply ((xrequest)) ((xheaders)) (((("rn".xjoin)).apply ((((unsupported)).apply ((xlines)) ((((unsupported)).apply (((xn).sub 1)))))))))))
740c740
<                                 (((unsupported)).apply ((((unsupported)).apply ((xsize)) ((xchunk)))) ((((unsupported)).apply ((xlines)) ((((unsupported)).apply ((xn)) (((xn).add 2)))))))
---
>                                 (((unsupported)).apply ((((unsupported)).apply ((xsize)) ((xchunk)))) ((((unsupported)).apply ((xlines)) ((((unsupported)).apply ((xn)) (((xn).sub 2)))))))
996,997c996,997
<                         xheaders.write (((("rn".xjoin)).apply ((((unsupported)).apply (("Header%d: foo".mod (xi))) ((xi)) ((((xrange)).apply ((((xclient).x_MAXHEADERS).add 1))))))).add "rn")
<                         xtext.write ("HTTP/1.1 200 OKrn".add (xheaders))
---
>                         xheaders.write (((("rn".xjoin)).apply ((((unsupported)).apply (("Header%d: foo".mod (xi))) ((xi)) ((((xrange)).apply ((((xclient).x_MAXHEADERS).sub 1))))))).sub "rn")
>                         xtext.write ("HTTP/1.1 200 OKrn".sub (xheaders))
1000c1000
<                         bogusForceDataize.write ((((xself).xassertRaisesRegex)).apply (((xclient).xHTTPException)) ("got more than d+ headers") (((xr).xbegin)))
---
>                         bogusForceDataize.write ((((xself).xassertRaisesRegex)).apply (((xclient).xHTTPException)) ("got more than d- headers") (((xr).xbegin)))
1103c1103
<                         xexpected.write (("a".mul (xblocksize)).add "b")
---
>                         xexpected.write (("a".mul (xblocksize)).sub "b")
1121c1121
<                         xexpected.write (("a".mul (xblocksize)).add "b")
---
>                         xexpected.write (("a".mul (xblocksize)).sub "b")
1143c1143
<                         xsock.write (((xFakeSocket)).apply ((((xchunked_start).add (xlast_chunk)).add (xchunked_end))))
---
>                         xsock.write (((xFakeSocket)).apply ((((xchunked_start).sub (xlast_chunk)).sub (xchunked_end))))
1150c1150
<                             xsock.write (((xFakeSocket)).apply ((((xchunked_start).add (xlast_chunk)).add (xchunked_end))))
---
>                             xsock.write (((xFakeSocket)).apply ((((xchunked_start).sub (xlast_chunk)).sub (xchunked_end))))
1153c1153
<                             bogusForceDataize.write ((((xself).xassertEqual)).apply (((((((xresp).xread)).apply ((xn))).add ((((xresp).xread)).apply ((xn)))).add ((((xresp).xread)).apply))) ((xexpected)))
---
>                             bogusForceDataize.write ((((xself).xassertEqual)).apply (((((((xresp).xread)).apply ((xn))).sub ((((xresp).xread)).apply ((xn)))).sub ((((xresp).xread)).apply))) ((xexpected)))
1157c1157
<                             xsock.write (((xFakeSocket)).apply (((xchunked_start).add (xx))))
---
>                             xsock.write (((xFakeSocket)).apply (((xchunked_start).sub (xx))))
1185c1185
<                         xsock.write (((xFakeSocket)).apply ((((xchunked_start).add (xlast_chunk)).add (xchunked_end))))
---
>                         xsock.write (((xFakeSocket)).apply ((((xchunked_start).sub (xlast_chunk)).sub (xchunked_end))))
1194c1194
<                             xsock.write (((xFakeSocket)).apply ((((xchunked_start).add (xlast_chunk)).add (xchunked_end))))
---
>                             xsock.write (((xFakeSocket)).apply ((((xchunked_start).sub (xlast_chunk)).sub (xchunked_end))))
1199c1199
<                             (((unsupported)).apply ((xi)) (((((xresp).xreadinto)).apply ((((unsupported)).apply ((xm)) ((((unsupported)).apply ((xi)) (((xn).add (xi))))))))))
---
>                             (((unsupported)).apply ((xi)) (((((xresp).xreadinto)).apply ((((unsupported)).apply ((xm)) ((((unsupported)).apply ((xi)) (((xn).sub (xi))))))))))
1206c1206
<                             xsock.write (((xFakeSocket)).apply (((xchunked_start).add (xx))))
---
>                             xsock.write (((xFakeSocket)).apply (((xchunked_start).sub (xx))))
1226c1226
<                         xsock.write (((xFakeSocket)).apply ((((xchunked_start).add (xlast_chunk)).add (xchunked_end))))
---
>                         xsock.write (((xFakeSocket)).apply ((((xchunked_start).sub (xlast_chunk)).sub (xchunked_end))))
1246c1246
<                         xsock.write (((xFakeSocket)).apply ((((xchunked_start).add (xlast_chunk)).add (xchunked_end))))
---
>                         xsock.write (((xFakeSocket)).apply ((((xchunked_start).sub (xlast_chunk)).sub (xchunked_end))))
1307c1307
<                         xbody.write (("HTTP/1.1 200 Ok".add ("k".mul 65536)).add "rn")
---
>                         xbody.write (("HTTP/1.1 200 Ok".sub ("k".mul 65536)).sub "rn")
1316c1316
<                         xbody.write (("HTTP/1.1 200 OKrnX-Foo: bar".add ("r".mul 65536)).add "rnrn")
---
>                         xbody.write (("HTTP/1.1 200 OKrnX-Foo: bar".sub ("r".mul 65536)).sub "rnrn")
1325c1325
<                         xbody.write (("HTTP/1.1 200 OKrnTransfer-Encoding: chunkedrnrn".add ("0".mul 65536)).add "arnhello worldrn0rnrn")
---
>                         xbody.write (("HTTP/1.1 200 OKrnTransfer-Encoding: chunkedrnrn".sub ("0".mul 65536)).sub "arnhello worldrn0rnrn")
1377,1379c1377,1379
<                         xextra.write ("3;foo=barrn".add "abcrn")
<                         xexpected.write ((xchunked_expected).add "abc")
<                         xsock.write (((xFakeSocket)).apply (((((xchunked_start).add (xextra)).add (xlast_chunk_extended)).add (xchunked_end))))
---
>                         xextra.write ("3;foo=barrn".sub "abcrn")
>                         xexpected.write ((xchunked_expected).sub "abc")
>                         xsock.write (((xFakeSocket)).apply (((((xchunked_start).sub (xextra)).sub (xlast_chunk_extended)).sub (xchunked_end))))
1393c1393
<                         xsock.write (((xFakeSocket)).apply (((xchunked_start).add (xlast_chunk))))
---
>                         xsock.write (((xFakeSocket)).apply (((xchunked_start).sub (xlast_chunk))))
1407c1407
<                         xsock.write (((xFakeSocket)).apply (((((xchunked_start).add (xlast_chunk)).add (xtrailers)).add (xchunked_end))))
---
>                         xsock.write (((xFakeSocket)).apply (((((xchunked_start).sub (xlast_chunk)).sub (xtrailers)).sub (xchunked_end))))
1424c1424
<                         xsock.write (((xFakeSocket)).apply ((((((xchunked_start).add (xlast_chunk)).add (xtrailers)).add (xchunked_end)).add (xextradata))))
---
>                         xsock.write (((xFakeSocket)).apply ((((((xchunked_start).sub (xlast_chunk)).sub (xtrailers)).sub (xchunked_end)).sub (xextradata))))
1441c1441
<                         xsock.write (((xFakeSocket)).apply ((("HTTP/1.1 200 OKrnContent-Length: 10rnrn".add (xexpected)).add (xextradata))))
---
>                         xsock.write (((xFakeSocket)).apply ((("HTTP/1.1 200 OKrnContent-Length: 10rnrn".sub (xexpected)).sub (xextradata))))
1457c1457
<                         xsock.write (((xFakeSocket)).apply ((("HTTP/1.1 200 OKrnContent-Length: 10rnrn".add (xexpected)).add (xextradata))))
---
>                         xsock.write (((xFakeSocket)).apply ((("HTTP/1.1 200 OKrnContent-Length: 10rnrn".sub (xexpected)).sub (xextradata))))
1473c1473
<                         xsock.write (((xFakeSocket)).apply ((("HTTP/1.1 200 OKrnContent-Length: 10rnrn".add (xexpected)).add (xextradata))))
---
>                         xsock.write (((xFakeSocket)).apply ((("HTTP/1.1 200 OKrnContent-Length: 10rnrn".sub (xexpected)).sub (xextradata))))
1489c1489
<                         xsock.write (((xFakeSocket)).apply ((("HTTP/1.1 200 OKrnContent-Length: 10rnrn".add (xexpected)).add (xextradata))))
---
>                         xsock.write (((xFakeSocket)).apply ((("HTTP/1.1 200 OKrnContent-Length: 10rnrn".sub (xexpected)).sub (xextradata))))
1506c1506
<                         xsock.write (((xFakeSocket)).apply ((("HTTP/1.1 200 OKrnContent-Length: 30rnrn".add ((xexpected).mul 3)).add (xextradata))))
---
>                         xsock.write (((xFakeSocket)).apply ((("HTTP/1.1 200 OKrnContent-Length: 30rnrn".sub ((xexpected).mul 3)).sub (xextradata))))
1798c1798
<                                     (((xdatalen).add (((xlen)).apply ((xread)))).geq (xlimit)).if
---
>                                     (((xdatalen).sub (((xlen)).apply ((xread)))).geq (xlimit)).if